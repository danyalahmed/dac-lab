apiVersion: seaweed.seaweedfs.com/v1
kind: Seaweed
metadata:
  name: seaweedfs-cluster # Kustomize matches this to the base name
  namespace: shared-services
spec:
  # CHANGE 2: Force the Filer to use LevelDB on NFS instead of Postgres
  volume:
    annotations:
      istio.io/dataplane-mode: none
  master:
    annotations:
      istio.io/dataplane-mode: none
  filer:
    annotations:
      istio.io/dataplane-mode: none
    persistence:
      storageClassName: "nfs-client"
      resources:
        requests:
          storage: 5Gi
    s3:
      enabled: true
      configSecret:
        name: seaweedfs-s3-secondary-config
        key: s3-config.json
    config: |
      [leveldb2]
      enabled = true
      dir = "/data/filerdb2"